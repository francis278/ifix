<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>MTSAppBar</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="IMG Developer's Kit"
HREF="home.html"><LINK
REL="UP"
TITLE="Developer Tools and Examples"
HREF="devtools.html"><LINK
REL="PREVIOUS"
TITLE="Modal Input Utility"
HREF="modalinput.html"><LINK
REL="NEXT"
TITLE="MTSDock (MTSAppBar)"
HREF="mtsdock.html"></HEAD
><BODY
CLASS="sect1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
><SPAN
CLASS="productname"
>IMG Developer's Kit</SPAN
>: Developer's Kit Guide and Technical Documentation; Version 1.79; User's Guide</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="modalinput.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 8. Developer Tools and Examples</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="mtsdock.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="sect1"
><H1
CLASS="sect1"
><A
NAME="MTSAppBar"
>MTSAppBar</A
></H1
><P
><SPAN
CLASS="bold"
><B
CLASS="emphasis"
>FOLDER: MTSAppBar</B
></SPAN
></P
><P
><SPAN
CLASS="bold"
><B
CLASS="emphasis"
>TYPE: Utility / Stand-alone Executable with Source</B
></SPAN
></P
><P
><SPAN
CLASS="bold"
><B
CLASS="emphasis"
>SOURCE: INCLUDED</B
></SPAN
></P
><P
><SPAN
CLASS="bold"
><B
CLASS="emphasis"
>LANGUAGE: C++ / Windows API</B
></SPAN
></P
><P
><SPAN
CLASS="bold"
><B
CLASS="emphasis"
>IDE: Microsoft Visual C++ 6</B
></SPAN
></P
><P
>MTSAppBar interface is primarily for OnScreen - not tested with other builds.</P
><P
>The MTSAppBar source code was modified from the AppBar example available from Microsoft showing and integrated with OnScreen to trap OnScreen on the AppBar.  The AppBar shell interface within Windows provides something similar to the Auto-Arrange windows in OnScreen - a way to limit Applications screen area and separate the OnScreen display from the Application being typed into.  If actually used, turning off Auto-Arrange in OnScreen Setup | User Options | Operation Options, and clearing items like Allow Action Button move, etc. may make using OnScreen with the AppBar more effective.</P
><P
>The MTSAppBar executable creates a top or bottom based "AppBar" or a special window that changes the desktop window size.</P
><P
>This has a timer running (internal ID: IDT_MONITOR) that watches the OnScreen keyboard window, and reacts if the window is sized or moved - this resets the appbar to go to the top or bottom &#38; size to the current keyboard size.</P
><P
>The code was modified from Microsoft sample code that created a more customizable appbar, similar to the Windows taskbar - so certain modifications were done to limit what could be done with this implementation of the AppBar.</P
><P
>Most of the code remains untouched, but there were minor modifications throughout. Here are notes on the changes:</P
><P
>Comments were modified throughout</P
><P
>UTIL.C - removed (slidewindow)</P
><P
>PROPSHT.C - removed (property sheet dialog)</P
><P
>GLOBALS.H - IDT_MONITOR ADDED</P
><P
>APPBAR.H - comments only</P
><P
>MYTSOFT.H - added, but slightly modified from normal Developer's Kit MYTSOFT.H (DEVKIT folder)</P
><P
>MAIN.C - code was added to the bottom for various utility aspects required, mainly coordinating with the My-T-Soft code - there were also add-ons in WinMain to prepare operation. </P
><P
>The window was created with out a thick frame (and the sizing/moving code modified - only menu commands can move window, and only to top &#38; bottom)</P
><P
>APPBAR.C - Minor modifications (force desktop window redraw whenever _SetSide called</P
><P
>WNDPROC.C - Various modification throughout to accommodate changes to implementation 
(mostly OnTimer, OnCommand, OnCreate, OnPaint code removed)</P
><P
>APPBAR.RC - the about dialog modified, and menu modified, along with icon &#38; bitmap</P
><P
>Comments:</P
><P
>The WinMain prep (MAIN.C) and OnTimer code (WNDPROC.C) is the most significant, along with the call to GetMTSAppBarHeight (MAIN.C) to establish correct window height.</P
><P
>The PrepareMyTSoft works with DevKit tools &#38; messages to establish the correct INI file, and verify the MTSAppBar entry is in the DoNotArrangeClasses (Very IMPORTANT for correct operation).</P
><P
>Usage Notes:</P
><P
>Expects OnScreen to be running before it is launched (otherwise messagebox shown).  Option to add a "WAIT" command line option to run in a "Sleep" (pause) loop to wait for OnScreen to open &#38; paint (in case both are started at the same time (i.e. Windows StartUp Group).  Run in a shortcut with "...\MTSAppBar.exe" WAIT</P
><P
>The code was built &#38; tested in Microsoft Visual Studio 6 with Windows 2000.</P
><P
>AppBar example Copyright Microsoft Corporation.</P
><P
>Developers Kit Version 1.78 Release 3 - 9/22/2007</P
><P
>Copyright © 2007 by Innovation Management Group, Inc.</P
><P
>All Rights Reserved.</P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="modalinput.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="home.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="mtsdock.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Modal Input Utility</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="devtools.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>MTSDock (MTSAppBar)</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>
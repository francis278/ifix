<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Build-A-Macro Notes</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="My-T-Soft®"
HREF="home.html"><LINK
REL="UP"
TITLE="Operation Notes"
HREF="operationnotes.html"><LINK
REL="PREVIOUS"
TITLE="Keyboard Notes"
HREF="keyboardnotes.html"><LINK
REL="NEXT"
TITLE="Memory"
HREF="memorynotes.html"></HEAD
><BODY
CLASS="sect1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
><SPAN
CLASS="productname"
>My-T-Soft</SPAN
><SUP
>®</SUP
>: for Windows; Indestructible Keyboards and Indispensable Utilities; Version 1.80; User's Guide</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="keyboardnotes.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 9. Operation Notes</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="memorynotes.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="sect1"
><H1
CLASS="sect1"
><A
NAME="BuildAMacroNotes"
>Build-A-Macro Notes</A
></H1
><P
>The following double-characters are reserved in Build-A-Macro:</P
><P
>@@ - Signifies an Alt keystroke to follow</P
><P
>     e.g. @@f = [Alt-Down]f[Alt-Up]</P
><P
>~~ - Signifies a Ctrl keystroke to follow</P
><P
>^^ - Signifies a Shift keystroke to follow</P
><P
>$$ - used internally for internal macro uses</P
><P
>%% - used to specify a virtual key, internal keystroke, or a keyboard scan code</P
><P
>You may not use these character combinations in your macros,
	unless you use them as outlined. For example, you may quickly
	create a macro for File, New ([Alt]-F, N) by entering "@@fn"
	and clicking OK. However, using the Reserved words in brackets
	is the preferred method.</P
><P
>The %% sequence has 4 options, and must be formed properly to
	be interpreted as an special entry. 4 characters must follow the
	2 percent signs, spaces are not allowed.  When this is used, 
	it generates both the Down and Up keyboard messages, (press &#38; 
	release), similar to the entry of a specific character.</P
><P
>The following general form is:</P
><P
>%%cnnn</P
><P
>where c is a character signifying Keystroke or Scancode or 
	Virtual Key Code or ProcessKey keystroke - The only valid characters are k or s or v or p 
	(case does not matter)</P
><P
>The nnn must be 3 decimal digits (values between 000 and 999 
	are valid).  Note that there are only 200+ keys on the panels and 
	255 Virtual keys - higher numbers may cause memory access errors!</P
><P
>The keystroke (k) numbers refer to the internal numbering of the 
	keyboard - see below for a table of the standard 101 keyboard.</P
><P
>For example, to generate a F10 keystroke, you may use "%%k010" in
	the Build-A-Macro portion.  In most cases, using the actual character 
	will generate the appropriate scan codes internally, and this is only 
	provided as an enhancement to provide more functionality in certain
	environments.  Documented deficiencies include lack of support for
	the keys on the Numeric keypad panel.  Additionally, by using the
	scancodes, macros can generate "keystrokes" for keys that are not
	present on the physical keyboard.  Because of the hardware oriented
	nature of the actual scancode generated by the physical keyboard, and
	its interpretation by the system hardware and Windows, the scope of
	these issues requires that they be referenced in appropriate system 
	manuals, and/or documentation on industry standards.</P
><P
>The Virtual Key (v) passes the Windows based Virtual key code directly
	through <SPAN
CLASS="productname"
>My-T-Soft</SPAN
>.  How an application interprets the virtual key code is
	dependent on regional, language, keyboard layout, and possibly other
	issues.</P
><P
>The ProcessKey (p) approach uses the internal ProcessKey function 
	which handles more internal processing beyond the AcceptCode function handled
	by the k, s, or v options.  This was added to allow macros to interact with
	the WordComplete panel on the Assistive Technology version.</P
><DIV
CLASS="note"
><BLOCKQUOTE
CLASS="note"
><P
><B
>Technical Information: </B
>The internal interface uses the AcceptCode approach which adds the keystroke
	to the buffer to be typed.  This is managed in different ways as specified based on the
	k, v, or s options.  The p option calls the internal ProcessKey that does various tasks
	prior to calling the AcceptCode function to insert the keystroke into the output
	buffer.  Because of the tightly interwoven aspects of ProcessKey, the keyboard panel, and
	special options such as WordComplete, there may be side-effects if the %%pnnn is used extensively.  
	There may also be other interactions with various other features (Show &#38; Hide Keys, LetterAssist, etc.)
	that the direct AcceptCode approach will completely bypass.
	The intended use is to allow a single macro button to type a letter, and interact with the
	WordComplete panel in the Assistive Technology version.</P
><P
>It is probably worthwhile to state that each of these approaches is important dependent
	on the context that you want a particular keystroke.  Is the keystroke dependent on the physical layout or virtual layout selected?  Is the keystroke a character typed into the application with keyboard
	focus?  Is the keystroke acting like it was typed on a the physical keyboard? Is the keystroke
	macro acting like it was typed on the virtual keyboard?  Each can be valid and required depending on many factors.  
	Supporting each possibility may explain one reason why the software has been around for 20 years.
	</P
></BLOCKQUOTE
></DIV
><P
>Quick Reference:</P
><P
>%%knnn, e.g. %%k010 - uses the currently selected KMF (<SPAN
CLASS="productname"
>My-T-Soft</SPAN
> 
	layout) and looks up the virtual key / scan code information for this key, 
	sends down/up keystrokes</P
><P
>%%snnn, e.g. %%s112 - sends the scancode, but processed internally.
	In most cases this will be the same virtual key code as specified, but
	it may be modified.</P
><P
>%%vnnn, e.g. %%v112 - sends the Windows Virtual Key (refer to 
	Microsoft documentation) unmodified (note decimal notation, hex is not
	supported).</P
><P
>%%pnnn, e.g. %%p041 - uses the currently selected KMF (<SPAN
CLASS="productname"
>My-T-Soft</SPAN
> 
	layout) and looks up the virtual key / scan code information for this key, 
	sends down/up keystrokes, and processes the key as if typed via the keyboard 
	directly.</P
><P
>Key# 	Description</P
><P
>   0    	Escape Key</P
><P
>   1    	F1</P
><P
>   2    	F2</P
><P
>   3    	F3</P
><P
>   4    	F4</P
><P
>   5    	F5</P
><P
>   6    	F6</P
><P
>   7    	F7</P
><P
>   8    	F8</P
><P
>   9    	F9</P
><P
>  10    	F10</P
><P
>  11   	F11</P
><P
>  12   	F12</P
><P
>  13    	Select key</P
><P
>  14    	1/!</P
><P
>  15    	2/@</P
><P
>  16    	3/#</P
><P
>  17    	4/$</P
><P
>  18    	5/%</P
><P
>  19    	6/^</P
><P
>  20    	7/&#38;</P
><P
>  21    	8/*</P
><P
>  22    	9/(</P
><P
>  23    	0/)</P
><P
>  24    	-/_</P
><P
>  25   	=/+</P
><P
>  26    	Back space</P
><P
>  27    	Tab</P
><P
>  28    	Q</P
><P
>  29    	W</P
><P
>  30    	E</P
><P
>  31    	R</P
><P
>  32    	T</P
><P
>  33    	Y</P
><P
>  34    	U</P
><P
>  35    	I</P
><P
>  36    	O</P
><P
>  37    	P</P
><P
>  38    	[/{</P
><P
>  39    	]/}</P
><P
>  40    	Caps Lock</P
><P
>  41    	A</P
><P
>  42    	S</P
><P
>  43    	D</P
><P
>  44    	F</P
><P
>  45    	G</P
><P
>  46    	H</P
><P
>  47    	J</P
><P
>  48    	K</P
><P
>  49    	L</P
><P
>  50    	;/:</P
><P
>  51    	'/"</P
><P
>  52    	Enter Key</P
><P
>  53    	Enter Key - make both waves 52.WAV &#38; 53.WAV</P
><P
>  54    	Shift / Left Shift</P
><P
>  55    	Z</P
><P
>  56    	X</P
><P
>  57   	C</P
><P
>  58    	V</P
><P
>  59    	B</P
><P
>  60    	N</P
><P
>  61    	M</P
><P
>  62    	,/&#60;</P
><P
>  63    	./&#62;</P
><P
>  64    	//?</P
><P
>  65    	Shift / Right Shift</P
><P
>  66    	\/|</P
><P
>  67    	Control / Left Control</P
><P
>  68    	Alt / Left Alt</P
><P
>  69    	Space Bar</P
><P
>  70    	Alt / Right Alt / Alt-Gr</P
><P
>  71    	Control / Left Control</P
><P
>These are on the edit panel</P
><P
>  72    	Print Screen</P
><P
>  73    	Scroll Lock</P
><P
>  74    	Pause</P
><P
>  75    	Insert</P
><P
>  76    	Home</P
><P
>  77    	Page Up</P
><P
>  78    	Delete</P
><P
>  79    	End</P
><P
>  80    	Page Down</P
><P
>  81    	Up Arrow</P
><P
>  82    	Left Arrow</P
><P
>  83    	Down Arrow</P
><P
>  84    	Right Arrow</P
><P
>These are on the Numeric keypad panel</P
><P
>  85    	CL indicator / not processed as key</P
><P
>  86    	NL indicator / not processed as key</P
><P
>  87    	SL indicator / not processed as key</P
><P
>  88    	Num Lock </P
><P
>  89    	/</P
><P
>  90    	*</P
><P
>  91    	-</P
><P
>  92    	7</P
><P
>  93    	8</P
><P
>  94    	9</P
><P
>  95    	+</P
><P
>  96    	4</P
><P
>  97    	5</P
><P
>  98    	6</P
><P
>  99    	1</P
><P
> 100    	2</P
><P
> 101    	3</P
><P
> 102    	Enter / =</P
><P
> 103    	0</P
><P
> 104    	decimal point</P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="keyboardnotes.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="home.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="memorynotes.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Keyboard Notes</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="operationnotes.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Memory</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>